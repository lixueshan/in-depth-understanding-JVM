# 第2章 Java内存区域与内存溢出异常

问题集：
```
1. 
2. 
3. 
```

## 运行时数据区

JVM管理的内存可划分为如下：

- 线程私有
  - 程序计数器
  - 虚拟机栈
  - 本地方法栈
- 线程共享
  - 方法区
  - 堆

### 各区域总结

| 区域 | 作用 | 内容 | 异常 | 其他 |
| --- | --- | --- | --- | --- |
| 程序计数器 |  当前线程所执行字节码的行号指示器 | 字节码位置信息 | 无OOM | CPU切换线程处理指令需要知道该线程处理到的位置，因此是线程私有的。 |
| 虚拟机栈 | 描述Java方法执行的线程内存模型 | 局部变量表<br>-编译器可知的基本数据类型<br>-对象引用<br>-returnAddress<br>操作数栈<br>动态连接<br>方法出口 | SOF/OOM | 一个方法的调用到执行结束对应一个栈帧在虚拟机栈中入栈到出栈。 |
| 本地方法栈 | 与虚拟机栈类似，但针对的是Native方法 | (略) | SOF/OOM | HotSpot将虚拟机栈和本地方法栈合二为一。 |
| 方法区 |  | 即时编译后的代码缓存<br>class被加载后的内容<br>-魔数<br>-版本信息<br>-运行时常量池<br>--字面量<br>---文本字符串<br>---被声明为final的常量值<br>--符号引用<br>---被模块导出或者开放的包<br>---类和接口的全限定名<br>---字段的名称和描述符<br>---方法句柄和方法类型<br>---动态调用点和动态常量<br>--直接引用<br>-类/父类/接口索引集合<br>-字段表集合<br>-方法表集合<br>-属性表集合 | OOM | JDK8后放弃永久代概念，以本地内存中实现的元空间来代表。物理上是对的一部分。|
| 堆 | 存放几乎所有对象实例 | 对象实例<br>java.lang.Class | OOM | 物理可不连续，逻辑连续。<br>可扩展(-Xmx/-Xms)。<br>从垃圾管理角度可分为不同年代区域。从分配内存角度，可废除多个线程私有的分配缓冲区(TLAB)|

## HotSpot虚拟机对象探秘
